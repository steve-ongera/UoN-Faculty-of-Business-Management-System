{% extends 'admin_base.html' %}

{% block title %}Delete Student - {{ student.registration_number }}{% endblock %}

{% block page_title %}Delete Student{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">

<style>
    .breadcrumb {
        padding: 0;
        margin-bottom: 20px;
        font-size: 14px;
        list-style: none;
        display: flex;
        flex-wrap: wrap;
    }

    .breadcrumb-item {
        color: #64748B;
    }

    .breadcrumb-item + .breadcrumb-item::before {
        content: "/ ";
        color: #94A3B8;
        padding: 0 8px;
    }

    .breadcrumb-item.active {
        color: #1E293B;
        font-weight: 500;
    }

    .breadcrumb a {
        color: #4F46E5;
        text-decoration: none;
    }

    .breadcrumb a:hover {
        color: #4338CA;
    }

    .section-container {
        background: white;
        border-radius: 5px;
        padding: 30px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
        margin-bottom: 20px;
        border: 1px solid #f0f0f0;
        max-width: 700px;
        margin-left: auto;
        margin-right: auto;
    }

    .warning-header {
        text-align: center;
        padding: 30px;
        background: linear-gradient(135deg, #FEF3C7 0%, #FEE2E2 100%);
        border-radius: 5px;
        margin-bottom: 30px;
    }

    .warning-icon {
        font-size: 64px;
        color: #DC2626;
        margin-bottom: 15px;
    }

    .warning-title {
        font-size: 24px;
        font-weight: 700;
        color: #991B1B;
        margin-bottom: 10px;
    }

    .warning-text {
        font-size: 14px;
        color: #92400E;
        line-height: 1.6;
    }

    .student-info {
        background: #F8FAFC;
        padding: 20px;
        border-radius: 5px;
        border: 1px solid #E2E8F0;
        margin-bottom: 30px;
    }

    .info-row {
        display: flex;
        justify-content: space-between;
        padding: 12px 0;
        border-bottom: 1px solid #E2E8F0;
    }

    .info-row:last-child {
        border-bottom: none;
    }

    .info-label {
        font-size: 14px;
        font-weight: 600;
        color: #64748B;
    }

    .info-value {
        font-size: 14px;
        color: #1E293B;
        font-weight: 500;
    }

    .consequences-list {
        background: #FEF3C7;
        padding: 20px;
        border-radius: 5px;
        border: 1px solid #FDE68A;
        margin-bottom: 30px;
    }

    .consequences-title {
        font-size: 16px;
        font-weight: 600;
        color: #92400E;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .consequences-list ul {
        margin: 0;
        padding-left: 20px;
        color: #92400E;
    }

    .consequences-list li {
        margin-bottom: 8px;
        font-size: 14px;
        line-height: 1.6;
    }

    .btn-group {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin-top: 30px;
        padding-top: 20px;
        border-top: 2px solid #F1F5F9;
    }

    .btn {
        padding: 14px 28px;
        border-radius: 5px;
        font-size: 15px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        border: none;
    }

    .btn-danger {
        background: #EF4444;
        color: white;
    }

    .btn-danger:hover {
        background: #DC2626;
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
    }

    .btn-secondary {
        background: #64748B;
        color: white;
    }

    .btn-secondary:hover {
        background: #475569;
        transform: translateY(-1px);
    }

    .note {
        background: #DBEAFE;
        padding: 15px;
        border-radius: 5px;
        border-left: 4px solid #3B82F6;
        margin-bottom: 20px;
    }

    .note-title {
        font-size: 14px;
        font-weight: 600;
        color: #1E40AF;
        margin-bottom: 5px;
    }

    .note-text {
        font-size: 13px;
        color: #1E3A8A;
        line-height: 1.6;
    }

    @media (max-width: 768px) {
        .section-container {
            padding: 20px;
        }

        .warning-header {
            padding: 20px;
        }

        .btn-group {
            flex-direction: column-reverse;
        }

        .info-row {
            flex-direction: column;
            gap: 5px;
        }
    }
</style>
{% endblock %}

{% block content %}
<!-- Breadcrumb -->
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'admin_dashboard' %}"><i class="bi bi-house-door"></i> Dashboard</a></li>
        <li class="breadcrumb-item"><a href="{% url 'student_list' %}">Students</a></li>
        <li class="breadcrumb-item"><a href="{% url 'student_detail' student.registration_number %}">{{ student.registration_number }}</a></li>
        <li class="breadcrumb-item active" aria-current="page">Delete</li>
    </ol>
</nav>

<div class="section-container">
    <!-- Warning Header -->
    <div class="warning-header">
        <div class="warning-icon">
            <i class="bi bi-exclamation-triangle"></i>
        </div>
        <h2 class="warning-title">Confirm Student Deactivation</h2>
        <p class="warning-text">
            You are about to deactivate this student account. This action will prevent the student from accessing the system.
        </p>
    </div>

    <!-- Note -->
    <div class="note">
        <div class="note-title">
            <i class="bi bi-info-circle"></i> Important Information
        </div>
        <p class="note-text">
            This is a soft delete operation. The student record will be deactivated but not permanently deleted from the database. 
            The student's data and academic history will be preserved but their account will be marked as inactive.
        </p>
    </div>

    <!-- Student Information -->
    <div class="student-info">
        <div class="info-row">
            <span class="info-label">Registration Number</span>
            <span class="info-value">{{ student.registration_number }}</span>
        </div>
        <div class="info-row">
            <span class="info-label">Full Name</span>
            <span class="info-value">{{ student.first_name }} {{ student.last_name }} {{ student.surname }}</span>
        </div>
        <div class="info-row">
            <span class="info-label">Email</span>
            <span class="info-value">{{ student.email|default:"N/A" }}</span>
        </div>
        <div class="info-row">
            <span class="info-label">Programme</span>
            <span class="info-value">{{ student.programme.code }} - {{ student.programme.name }}</span>
        </div>
        <div class="info-row">
            <span class="info-label">Current Year</span>
            <span class="info-value">Year {{ student.current_year }}</span>
        </div>
        <div class="info-row">
            <span class="info-label">Current Status</span>
            <span class="info-value">
                {% if student.is_active %}
                    <span style="color: #059669;">● Active</span>
                {% else %}
                    <span style="color: #DC2626;">● Inactive</span>
                {% endif %}
            </span>
        </div>
    </div>

    <!-- Consequences -->
    <div class="consequences-list">
        <div class="consequences-title">
            <i class="bi bi-exclamation-circle"></i>
            What will happen when you deactivate this student:
        </div>
        <ul>
            <li>The student will <strong>no longer be able to log in</strong> to the system</li>
            <li>The student account will be marked as <strong>inactive</strong></li>
            <li>All student data and academic records will be <strong>preserved</strong></li>
            <li>The student will not appear in <strong>active student lists</strong> by default</li>
            <li>The account can be <strong>reactivated later</strong> if needed</li>
            <li>No data will be permanently deleted from the database</li>
        </ul>
    </div>

    <!-- Confirmation Form -->
    <form method="post" action="{% url 'student_delete' student.registration_number %}" onsubmit="return confirm('Are you absolutely sure you want to deactivate this student account? This will prevent them from accessing the system.');">
        {% csrf_token %}
        
        <div class="btn-group">
            <a href="{% url 'student_detail' student.registration_number %}" class="btn btn-secondary">
                <i class="bi bi-x-circle"></i>
                Cancel
            </a>
            <button type="submit" class="btn btn-danger">
                <i class="bi bi-trash"></i>
                Yes, Deactivate Student
            </button>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
    console.log('Student delete confirmation page loaded');
</script>
{% endblock %}